plugins {
    id 'java-library'
    id 'maven-publish'
    id 'signing'
    id 'net.researchgate.release' version '2.6.0'
}

group 'eu.lucaventuri'
version version

sourceCompatibility = 11
targetCompatibility = 11

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
    testCompile 'org.reactivestreams:reactive-streams-tck-flow:1.0.3'
    testCompile group: 'org.testng', name: 'testng', version: '6.14.3'
}

apply from: 'publish.gradle'

sourceSets {
    tck {
        java.srcDirs = ['src/testng/java']
        resources.srcDirs = ['src/testng/resources']

        compileClasspath += main.output
        runtimeClasspath += main.output
    }
}

configurations {
    tckCompile.extendsFrom testCompile
    tckRuntime.extendsFrom testRuntime
}

task testng(type: Test) {
    description "TestNG for Reacttive streams TCK"
    useTestNG()
    def testClassesDir = sourceSets.tck.output.classesDirs
    classpath = sourceSets.tck.runtimeClasspath

    println testClassesDir
    println classpath
    beforeTest { descriptor ->
        logger.lifecycle("Test(ng): " + descriptor)
    }
    onOutput { descriptor, event ->
        logger.lifecycle("TestNG - " + descriptor + ": " + event.message)
    }
}


